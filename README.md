# DiceSimulator

サイコロを用いた標本平均の分布を可視化するデモアプリです．
Streamlitで動作し，中心極限定理（サンプルサイズが大きいと正規分布に近づく）と大数の法則（標本平均が真の平均3.5に収束する）を直感的に確認できます．
標本平均のヒストグラムと，ロール数（サンプルサイズ）を増やしたときの累積平均の収束をPNGとして表示・ダウンロードできます．

公開デモ（Streamlit Community Cloud）: https://dicesimulator-t-narumi-ukk.streamlit.app

## 特徴
- m（サンプル数）と n（サンプルサイズ）を入力してシミュレーションを実行
- 標本平均のヒストグラムに正規近似をオーバーレイ表示
- ロール数（サンプルサイズ）を増やしたときの累積平均の推移（大数の法則デモ）を折れ線グラフで表示
- ヒストグラムの x / y 軸範囲を手動設定可能
- 2つの図をそれぞれPNGとしてダウンロード可能
- 乱数シードを指定すれば再現可能，未指定なら都度ランダム
- KS 検定で標本分布と正規近似の一致度を表示（KS statistic と p-value を表示．KS statistic は0に近いほど差が小さく，p は小さいほど正規近似からの逸脱を示唆）
  - m の範囲: 1 〜 1,000,000
  - n の範囲: 1 〜 100,000（計算量に注意、n×m ≤ 1e8 を推奨）

## 依存関係
`requirements.txt` を参照してください（`streamlit`, `numpy`, `matplotlib`, `scipy`）．

## 使い方
1. 依存ライブラリをインストールします．
   ```bash
   pip install -r requirements.txt
   ```
2. Streamlitアプリを起動します．
   ```bash
   streamlit run app.py
   ```
3. ブラウザで開いたページのサイドバーで以下を設定し，「Run simulation」を押下します．
   - Sample count m: 標本数（標本平均を何個作るか）
   - Sample size n: 1回の標本内で振るサイコロの回数
   - Random seed: 「乱数シードを指定する」にチェックして整数を入力すると再現可能（チェックしなければ毎回ランダム）
   - Plot options: ヒストグラムの x / y 軸範囲を手動設定可能
4. メイン画面にヒストグラムと累積平均（サンプルサイズ方向）のグラフが表示されます．各グラフ下のボタンからPNGをダウンロードできます（ヒストグラムは n と m を、累積平均は n をファイル名に含みます）．

## 補足
- サンプルサイズ n を大きくするとヒストグラムは正規分布に近づきます（中心極限定理）．
- サンプルサイズ n を増やすと、累積平均（ロール数方向）が真の平均 3.5 に収束していく様子が確認できます（大数の法則）．
- サイドバーで n や m を調整して実行し直すことで，比較が簡単にできます．
- KS統計量は0に近いほど標本分布と正規近似の差が小さいです．
- p値は「正規分布と矛盾するほど差が大きいか」の指標で，小さいほど逸脱を示唆します．一般的な「p値は小さいほど良い」というイメージとは逆に，ここでは p が大きいほど正規近似と矛盾しない（棄却できない）と読みます．
